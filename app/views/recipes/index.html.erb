<div class="recipes-container">

  <!-- Search bar -->
  <div class="row justify-content-center">
    <div class="col-sm-8 my-3">
      <%= form_with url: (params[:available_ingredients_only].present? ? recipes_path(available_ingredients_only: true) : recipes_path), method: :get do |form|%>
        <%= form.search_field :query, data: { controller: "filter"} %>
        <%= form.submit "🔍" %>
      <% end %>

      <!-- Dropdown for recipe options -->
      <div class="dropdown">
        <button class="dropdown-toggle" type="button" data-bs-toggle="dropdown">
          <i class="fa-solid fa-list"></i>
        </button>
        <ul class="dropdown-menu">
          <li><%= link_to "All Recipes", recipes_path, class: "dropdown-item" %></li>
          <% if params[:query] %>
            <li><%= link_to "Recipes I can make", recipes_path(available_ingredients_only: true, query: params[:query]), class: "dropdown-item" %></li>
          <% else %>
            <li><%= link_to "Recipes I can make", recipes_path(available_ingredients_only: true), class: "dropdown-item" %></li>
          <% end %>
        </ul>
      </div>

    </div>
  </div>


  <% @recipes.each do |recipe| %>
    <div class="recipe-card" data-controller="recipedropdown">
      <div class="recipe-image">
        <%= link_to recipe_path(recipe) do %>
          <%= image_tag recipe.image_url, alt: "Recipe Image" %>
        <% end %>
        <button class="recipe-dropdown-button" data-action="click->recipedropdown#toggle">
          <i class="fa-solid fa-chevron-down fa-2xl"></i>
        </button>
      </div>

      <div class="recipe-info" data-recipedropdown-target="content">
        <h3><%= recipe.name %></h3>
        <p class="each-recipe-info"><strong>Cuisine:</strong> <%= recipe.cuisine %></p>
        <p class="each-recipe-info"><strong>Total time:</strong> <%= recipe.cook_time %></p>
        <p class="each-recipe-info"><strong>Difficulty:</strong> <%= recipe.difficulty.capitalize %></p>
      </div>
    </div>
  <% end %>
</div>
